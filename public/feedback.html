<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transport Feedback Form</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background: #f4f4f4;
            color: #333;
            min-height: 100vh;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 20px;
            background: #007bff;
            color: white;
        }

        .logo {
            font-size: 24px;
            font-weight: bold;
        }

        .back-button {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        #feedback-section {
            width: 500px;
            margin: 20px auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .transport-type {
            text-align: center;
            margin-bottom: 20px;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .transport-type i {
            font-size: 32px;
            color: #007bff;
            margin-right: 10px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        select, textarea {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
        }

        .star-rating {
            margin-bottom: 15px;
            text-align: center;
        }

        .star-rating .fa-star {
            font-size: 24px;
            cursor: pointer;
            color: gray;
            margin: 0 2px;
        }

        .star-rating .checked {
            color: orange;
        }

        textarea {
            height: 120px;
            resize: vertical;
        }

        button {
            background-color: #007bff;
            color: white;
            padding: 12px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            width: 100%;
            font-size: 16px;
        }

        button:hover {
            background-color: #0056b3;
        }

        .success-message {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 4px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: none;
        }
    </style>
</head>
<body>
    <header>
        <a href="./website2.html" class="back-button">
            <i class="fas fa-arrow-left"></i>
            Back
        </a>
        <div class="logo">Public Transport</div>
        <div></div>
    </header>

    <section id="feedback-section">
        <div class="transport-type">
            <i id="transport-icon" class="fas"></i>
            <span id="transport-title"></span>
        </div>

        <label for="start-location">Start Location:</label>
        <select id="start-location" name="start-location">
            <option value="">-- Select Start Location --</option>
        </select>

        <label for="end-location">End Location:</label>
        <select id="end-location" name="end-location">
            <option value="">-- Select End Location --</option>
        </select>

        <label for="route">Vehicle Number:</label>
        <select id="route" name="route">
            <option value="">-- Select a vehicle --</option>
        </select>

        <div class="star-rating">
            <span class="fa fa-star" onclick="rateStar(1)"></span>
            <span class="fa fa-star" onclick="rateStar(2)"></span>
            <span class="fa fa-star" onclick="rateStar(3)"></span>
            <span class="fa fa-star" onclick="rateStar(4)"></span>
            <span class="fa fa-star" onclick="rateStar(5)"></span>
        </div>

        <textarea id="comment" placeholder="Write your feedback..."></textarea>

        <button onclick="submitFeedback()">Submit Feedback</button>
    </section>

    <div id="success-message" class="success-message">
        Feedback submitted successfully!
    </div>

    <script>
        let selectedRating = 0;
        let currentTransportType = '';
        
        const vehicles = {
            bus: {
                "TN-22-B-1234": { start: "Koyambedu", end: "Tambaram" },
                "TN-22-C-5678": { start: "Guindy", end: "Siruseri" },
                "TN-22-D-9012": { start: "Avadi", end: "Velachery" },
                "TN-22-E-3456": { start: "Poonamallee", end: "T.Nagar" },
                "TN-22-F-7890": { start: "Tambaram", end: "Chennai Beach" },
                "TN-22-G-2468": { start: "Egmore", end: "Bengaluru" }
            },
            train: {
                "SR-001": { start: "Chennai Central", end: "Arakkonam" },
                "SR-002": { start: "Chennai Beach", end: "Velachery" },
                "SR-003": { start: "Egmore", end: "Madurai" },
                "SR-004": { start: "Tambaram", end: "Chengalpattu" },
                "SR-005": { start: "Chennai Central", end: "Bengaluru" },
                "SR-006": { start: "Avadi", end: "Tiruvallur" }
            },
            metro: {
                "CMRL-109": { start: "Washermanpet", end: "Chennai Airport" },
                "CMRL-110": { start: "Koyambedu", end: "Guindy" },
                "CMRL-111": { start: "T.Nagar", end: "Velachery" },
                "CMRL-112": { start: "Central", end: "Airport" },
                "CMRL-113": { start: "Egmore", end: "Washermanpet" },
                "CMRL-114": { start: "Guindy", end: "Thirumangalam" }
            }
        };

        // Initialize page when loaded
        window.onload = function() {
            const urlParams = new URLSearchParams(window.location.search);
            const transportType = urlParams.get('type');
            
            if (transportType && vehicles[transportType]) {
                currentTransportType = transportType;
                
                // Set transport icon and title
                const iconMap = {
                    bus: 'fa-bus',
                    train: 'fa-train',
                    metro: 'fa-subway',
                    tram: 'fa-tram'
                };
                
                document.getElementById('transport-icon').className = `fas ${iconMap[transportType]}`;
                document.getElementById('transport-title').textContent = 
                    transportType.charAt(0).toUpperCase() + transportType.slice(1) + ' Feedback';
                
                // Populate start locations
                const startLocations = new Set();
                Object.values(vehicles[transportType]).forEach(route => {
                    startLocations.add(route.start);
                });
                
                const startSelect = document.getElementById('start-location');
                startLocations.forEach(location => {
                    const option = document.createElement('option');
                    option.value = location;
                    option.textContent = location;
                    startSelect.appendChild(option);
                });
            } else {
                window.location.href = 'index.html';
            }
        };

        // Update end locations when start location changes
        document.getElementById('start-location').addEventListener('change', function() {
            const startLocation = this.value;
            const endSelect = document.getElementById('end-location');
            const routeSelect = document.getElementById('route');
            
            // Reset end location and route selections
            endSelect.innerHTML = '<option value="">-- Select End Location --</option>';
            routeSelect.innerHTML = '<option value="">-- Select a vehicle --</option>';
            
            if (!startLocation) return;
            
            // Find all possible end locations for the selected start location
            const endLocations = new Set();
            Object.values(vehicles[currentTransportType]).forEach(route => {
                if (route.start === startLocation) {
                    endLocations.add(route.end);
                }
            });
            
            endLocations.forEach(location => {
                const option = document.createElement('option');
                option.value = location;
                option.textContent = location;
                endSelect.appendChild(option);
            });
        });

        // Update vehicle options when end location changes
        document.getElementById('end-location').addEventListener('change', function() {
            const startLocation = document.getElementById('start-location').value;
            const endLocation = this.value;
            const routeSelect = document.getElementById('route');
            
            routeSelect.innerHTML = '<option value="">-- Select a vehicle --</option>';
            
            if (!startLocation || !endLocation) return;
            
            Object.entries(vehicles[currentTransportType]).forEach(([vehicleId, route]) => {
                if (route.start === startLocation && route.end === endLocation) {
                    const option = document.createElement('option');
                    option.value = vehicleId;
                    option.textContent = vehicleId;
                    routeSelect.appendChild(option);
                }
            });
        });

        function rateStar(star) {
            selectedRating = star;
            const stars = document.querySelectorAll('.fa-star');
            stars.forEach((s, index) => {
                s.classList.toggle('checked', index < star);
            });
        }

        function showSuccessMessage() {
            const message = document.getElementById('success-message');
            message.style.display = 'block';
            setTimeout(() => {
                message.style.display = 'none';
            }, 3000);
        }

        function submitFeedback() {
            const startLocation = document.getElementById('start-location').value;
            const endLocation = document.getElementById('end-location').value;
            const vehicleId = document.getElementById('route').value;
            const comment = document.getElementById('comment').value;

            if (!startLocation || !endLocation || !vehicleId || !selectedRating) {
                alert("Please fill in all required fields and provide a rating.");
                return;
            }

            const feedbackData = {
                transportType: currentTransportType,
                startLocation,
                endLocation,
                vehicleId,
                rating: selectedRating,
                comment,
                timestamp: new Date().toISOString()
            };

            console.log('Feedback data:', feedbackData);
            showSuccessMessage();

            // Reset form
            document.getElementById('start-location').value = '';
            document.getElementById('end-location').value = '';
            document.getElementById('route').value = '';
            document.getElementById('comment').value = '';
            selectedRating = 0;
            document.querySelectorAll('.fa-star').forEach(star => star.classList.remove('checked'));

            // Redirect after delay
            setTimeout(() => {
                window.location.href = 'index.html';
            }, 2000);
        }
    </script>
</body>
</html>